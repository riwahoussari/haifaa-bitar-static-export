"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[778],{8778:(e,t,i)=>{i.r(t),i.d(t,{default:()=>o});class s{constructor(e=window){this.addListener=e=>(this.listeners.push(e),e),this.removeListener=e=>{this.listeners=this.listeners.filter(t=>t!==e)},this.listen=()=>{this.window.addEventListener("message",this.receive,!1)},this.unlisten=()=>{this.window.removeEventListener("message",this.receive)},this.receive=e=>{let t=this.listeners.find(t=>t.iFrame.contentWindow===e.source);if("string"!=typeof e.data||"appointlet:"!==e.data.substr(0,11)||!t)return;let i=JSON.parse(e.data.substr(11));t.callback(i)},this.window=e,this.listeners=[],this.listen()}}var r=new s;class n{constructor(e){this.schedulingPageURL=e,this.__TIMEOUT__=3e4,this.listenForLoadedOrTimeOut=async e=>new Promise((t,i)=>{let s=r.addListener({iFrame:e,callback:e=>{"scheduler:loaded"===e.type&&(t(),r.removeListener(s))}});setTimeout(i,this.__TIMEOUT__)}),this.listenForCompletionOrAbandon=async e=>new Promise(t=>{let i=r.addListener({iFrame:e,callback:e=>{if("booking:created"===e.type&&(t(e.data),r.removeListener(i)),"scheduler:close"===e.type){t(null);let e=document.body;r.removeListener(i),e.classList.remove("modal-open")}}})}),this.url=e}async inlineEmbed(e){let t=document.createElement("iframe");t.setAttribute("src",this.getURLWithModeAndVersion("inline")),t.classList.add("appointlet-iframe","appointlet-inline"),e.appendChild(t);try{await this.listenForLoadedOrTimeOut(t)}catch(e){throw t.remove(),Error(`[@appointlet/appointlet.js]:

Failed to load scheduler`)}let i=await this.listenForCompletionOrAbandon(t);return i&&i.redirectUrl&&window.location.assign(i.redirectUrl),i}async openModal(){let e=document.createElement("div"),t=document.body;e.classList.add("appointlet-popover-backdrop"),t.appendChild(e);let i=document.createElement("div");i.classList.add("appointlet-loader"),e.appendChild(i),t.classList.add("modal-open");let s=document.createElement("iframe");s.setAttribute("src",this.getURLWithModeAndVersion("modal")),s.classList.add("appointlet-iframe","appointlet-popover"),t.appendChild(s);try{await this.listenForLoadedOrTimeOut(s)}catch(t){throw s.remove(),i.remove(),e.remove(),Error(`[@appointlet/appointlet.js]:

Failed to load scheduler`)}s.style.display="block";let r=!0,n=null;for(;r;){let e=await this.listenForCompletionOrAbandon(s);null===e?r=!1:n=e,n&&n.redirectUrl&&window.location.assign(n.redirectUrl)}return s.remove(),i.remove(),e.remove(),n}getURLWithModeAndVersion(e){return`${this.url}${this.url.indexOf("?")>-1?"&":"?"}mode=${e}&v=3.0.7`}}let o=n}}]);